<div xmlns:th="http://www.thymeleaf.org"
     th:replace="~{layout/base :: layout(~{::section})}">
  <section class="mx-auto w-full max-w-6xl px-4 py-10 md:px-6 md:py-14">

    <div class="flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between">
      <div>
        <p class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-white/70">
          <span class="h-1.5 w-1.5 rounded-full" style="background:#18FFEA;"></span>
          Admin • Designs
        </p>
        <h1 class="mt-4 text-3xl font-extrabold tracking-tight md:text-4xl">Design catalog</h1>
        <p class="mt-2 text-white/70">These designs can be added to drops and collections.</p>
      </div>

      <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end sm:gap-3">
        <a href="/admin"
           class="inline-flex items-center justify-center rounded-2xl border border-white/10 bg-white/5 px-5 py-3 text-sm font-semibold text-white/80 hover:bg-white/10">
          Back
        </a>

        <!-- Import from Gelato -->
        <a href="/admin/designs/import/gelato"
           class="inline-flex items-center justify-center rounded-2xl border border-white/10 bg-white/5 px-5 py-3 text-sm font-semibold text-white/80 hover:bg-white/10">
          Import from Gelato
        </a>

        <!-- Primary CTA -->
        <a href="/admin/designs/new"
           class="inline-flex items-center justify-center rounded-2xl px-6 py-3 text-sm font-semibold text-[#0A0A0A] teal-glow hover:teal-glow-strong"
           style="background:#18FFEA;">
          New design
        </a>
      </div>
    </div>

    <!-- Filters -->
    <form method="get" action="/admin/designs"
          class="mt-8 rounded-3xl border border-white/10 bg-[#121212] p-5">
      <div class="grid grid-cols-1 gap-4 md:grid-cols-12 md:items-end">

        <div class="md:col-span-7">
          <label class="text-xs text-white/70">Search</label>
          <input name="q"
                 th:value="${q}"
                 placeholder="Search by title…"
                 class="mt-1 w-full rounded-2xl border border-white/10 bg-black/30 px-4 py-2 text-sm outline-none focus:border-white/20" />
        </div>

        <div class="md:col-span-3">
          <label class="text-xs text-white/70">Status</label>
          <select name="status"
                  class="mt-1 w-full rounded-2xl border border-white/10 bg-black/30 px-4 py-2 text-sm outline-none focus:border-white/20">
            <option value="ALL" th:selected="${status == null || status == 'ALL'}">All</option>
            <option value="DRAFT" th:selected="${status == 'DRAFT'}">Draft</option>
            <option value="PUBLISHED" th:selected="${status == 'PUBLISHED'}">Published</option>
            <option value="ARCHIVED" th:selected="${status == 'ARCHIVED'}">Archived</option>
          </select>
        </div>

        <div class="md:col-span-2 flex gap-2">
          <button type="submit"
                  class="w-full rounded-2xl px-4 py-2 text-sm font-semibold text-[#0A0A0A] teal-glow hover:teal-glow-strong"
                  style="background:#18FFEA;">
            Apply
          </button>
          <a href="/admin/designs"
             class="w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2 text-center text-sm font-semibold text-white/80 hover:bg-white/10">
            Clear
          </a>
        </div>
      </div>
    </form>

    <div class="mt-8 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3">
      <div th:each="d : ${designs}"
           class="rounded-3xl border border-white/10 bg-[#121212] p-5 hover:border-white/20">

        <div class="flex items-start justify-between gap-4">
          <div>
            <p class="font-semibold" th:text="${d.title}">Title</p>
            <p class="mt-1 text-sm text-white/60">
              <span th:text="${d.status}">DRAFT</span>
              <span class="text-white/30">•</span>
              <span th:text="${d.slug}">slug</span>
            </p>
          </div>

          <span class="rounded-xl border border-white/10 bg-white/5 px-2 py-1 text-xs text-white/70"
                th:text="${d.id}">1</span>
        </div>

        <p class="mt-3 text-sm text-white/70 line-clamp-3"
           th:text="${d.description}">Description</p>

        <!-- Actions -->
        <div class="mt-5 grid grid-cols-2 gap-3">
          <a th:href="@{'/admin/designs/' + ${d.id} + '/edit'}"
             class="inline-flex items-center justify-center rounded-2xl border border-white/10 bg-white/5 px-4 py-2 text-sm font-semibold text-white/80 hover:bg-white/10">
            Edit
          </a>

          <!-- DRAFT -> Publish -->
          <form th:if="${d.status == 'DRAFT'}"
                th:action="@{'/admin/designs/' + ${d.id} + '/publish'}"
                method="post">
            <div th:replace="~{fragments/csrf :: csrf}"></div>
            <button type="submit"
                    class="w-full rounded-2xl px-4 py-2 text-sm font-semibold text-[#0A0A0A] teal-glow hover:teal-glow-strong"
                    style="background:#18FFEA;">
              Publish
            </button>
          </form>

          <!-- Not archived -> Archive -->
          <form th:if="${d.status != 'ARCHIVED'}"
                th:action="@{'/admin/designs/' + ${d.id} + '/archive'}"
                method="post">
            <div th:replace="~{fragments/csrf :: csrf}"></div>
            <button type="submit"
                    class="w-full rounded-2xl border border-white/10 bg-black/30 px-4 py-2 text-sm font-semibold text-white/80 hover:bg-white/10">
              Archive
            </button>
          </form>

          <!-- Archived -> Unarchive -->
          <form th:if="${d.status == 'ARCHIVED'}"
                th:action="@{'/admin/designs/' + ${d.id} + '/unarchive'}"
                method="post">
            <div th:replace="~{fragments/csrf :: csrf}"></div>
            <button type="submit"
                    class="w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2 text-sm font-semibold text-white/80 hover:bg-white/10">
              Unarchive
            </button>
          </form>

          <!-- Published -> Archive (shows via the not-archived form) -->
        </div>

      </div>

      <div th:if="${#lists.isEmpty(designs)}"
           class="rounded-3xl border border-white/10 bg-[#121212] p-6">
        <p class="text-white/80 font-semibold">No designs yet.</p>
        <p class="mt-2 text-sm text-white/60">Create your first design to start building drops.</p>
      </div>
    </div>
  </section>
</div>
