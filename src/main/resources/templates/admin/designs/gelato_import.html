<div xmlns:th="http://www.thymeleaf.org"
     th:replace="~{layout/base :: layout(~{::section})}">
  <section class="mx-auto w-full max-w-6xl px-4 py-10 md:px-6 md:py-14">

    <div class="flex items-end justify-between gap-6">
      <div>
        <p class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-white/70">
          <span class="h-1.5 w-1.5 rounded-full" style="background:#18FFEA;"></span>
          Admin • Designs • Import
        </p>
        <h1 class="mt-4 text-3xl font-extrabold tracking-tight md:text-4xl">Import from Gelato</h1>
        <p class="mt-2 text-white/70">Bring published products from your Gelato Custom store into DT as Designs.</p>

        <div th:if="${alreadyImported}" class="mt-4 rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-white/80">
          That product was already imported.
        </div>
      </div>

      <a href="/admin/designs"
         class="inline-flex items-center justify-center rounded-2xl border border-white/10 bg-white/5 px-5 py-3 text-sm font-semibold text-white/80 hover:bg-white/10">
        Back to designs
      </a>
    </div>

    <div class="mt-8 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3">
      <div th:each="p : ${products}"
           class="rounded-3xl border border-white/10 bg-[#121212] p-5 hover:border-white/20">

        <div class="flex items-start justify-between gap-4">
          <div>
            <p class="font-semibold" th:text="${p.title}">Product title</p>
            <p class="mt-1 text-sm text-white/60">
              <span class="text-white/40">Gelato ID:</span>
              <span th:text="${p.id}">id</span>
            </p>
          </div>

          <span th:if="${importedIds.contains(p.id)}"
                class="rounded-xl border border-white/10 bg-white/5 px-2 py-1 text-xs font-semibold"
                style="color:#18FFEA;">
            Imported
          </span>
        </div>

        <p class="mt-3 text-sm text-white/70 line-clamp-3">
          <span class="text-white/40">Created:</span>
          <span th:text="${p.createdAt}">2025-12-23T00:00:00Z</span>
        </p>

        <div class="mt-5">
          <form th:if="${!importedIds.contains(p.id)}"
                th:action="@{'/admin/designs/import/gelato/' + ${p.id}}"
                method="post">
            <button type="submit"
                    class="w-full rounded-2xl px-4 py-2 text-sm font-semibold text-[#0A0A0A] teal-glow hover:teal-glow-strong"
                    style="background:#18FFEA;">
              Import as Design
            </button>
          </form>

          <button th:if="${importedIds.contains(p.id)}"
                  disabled
                  class="w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2 text-sm font-semibold text-white/40">
            Already imported
          </button>
        </div>
      </div>

      <div th:if="${#lists.isEmpty(products)}"
           class="rounded-3xl border border-white/10 bg-[#121212] p-6">
        <p class="text-white/80 font-semibold">No products returned from Gelato.</p>
        <p class="mt-2 text-sm text-white/60">
          Make sure you’re using the Custom storeId and the product is published in that store.
        </p>
      </div>
    </div>

  </section>
</div>
